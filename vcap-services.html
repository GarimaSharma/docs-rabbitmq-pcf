<!doctype html>
<html>
<head>
  <meta charset="utf-8">

  <!-- Always force latest IE rendering engine or request Chrome Frame -->
  <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">

  <!-- Use title if it's in the page YAML frontmatter -->
  <title>RabbitMQ Entries in the VCAP_SERVICES Environment Variable | Pivotal RabbitMQ Docs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, minimum-scale=1, user-scalable=no" id="viewport" />

  <link href="../../stylesheets/master.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="../../stylesheets/breadcrumbs.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="../../stylesheets/search.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="../../stylesheets/portal-style.css" media="screen,print" rel="stylesheet" type="text/css" />
  <link href="../../stylesheets/printable.css" media="print" rel="stylesheet" type="text/css" />
  <script src="../../javascripts/all.js" type="text/javascript"></script>

  <link href='http://www.gopivotal.com/misc/favicon.ico' rel='shortcut icon'>

  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39702075-1']);
    _gaq.push(['_setDomainName', 'gopivotal.com']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

  </script>
</head>

<body class="pivotalcf pivotalcf_services pivotalcf_services_index">
  <div class="viewport">
    <div class="mobile-navigation--wrapper mobile-only">
      <div class="navigation-drawer--container">
        <div class="navigation-item-list">
          <div class="navbar-link active">
            <a href="http://gopivotal.com">
              Home
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/paas">
              PaaS
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/big-data">
              Big Data
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/agile">
              Agile
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/support">
              Help &amp; Support
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/products">
              Products
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/solutions">
              Solutions
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
          <div class="navbar-link">
            <a href="http://gopivotal.com/partners">
              Partners
              <i class="icon-chevron-right pull-right"></i>
            </a>
          </div>
        </div>
      </div>
      <div class="mobile-nav">
        <div class="nav-icon js-open-nav-drawer">
          <i class="icon-reorder"></i>
        </div>
        <div class="header-center-icon">
          <a href="http://gopivotal.com">
            <div class="icon icon-pivotal-logo-mobile"></div>
          </a>
        </div>
      </div>
    </div>

    <div class='wrap'>
      <script src="//use.typekit.net/clb0qji.js" type="text/javascript"></script>
      <script type="text/javascript">
          try {
              Typekit.load();
          } catch (e) {
          }
      </script>
      <script type="text/javascript">
          document.domain = "gopivotal.com";
      </script>
      <div id="search-dropdown-box">
        <div class="search-dropdown--container js-search-dropdown">
          <div class="container-fluid">
            <div class="close-menu-large"><img src="http://www.gopivotal.com/sites/all/themes/gopo13/images/icon-close.png" /></div>
            <div class="search-form--container">
              <div class="form-search">
                <div class='gcse-search'></div>
                <script src="http://www.google.com/jsapi" type="text/javascript"></script>
                <script src="../../javascripts/cse.js" type="text/javascript"></script>
              </div>
            </div>
          </div>
        </div>
      </div>

      <header class="navbar desktop-only" id="nav">
        <div class="navbar-inner">
            <div class="container-fluid">
                <div class="pivotal-logo--container">
                    <a class="pivotal-logo" href="http://gopivotal.com"><span></span></a>
                </div>

                <ul class="nav pull-right">
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/paas" id="paas-nav-link">PaaS</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/big-data" id="big-data-nav-link">BIG DATA</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/agile" id="agile-nav-link">AGILE</a>
                    </li>
                    <li class="navbar-link">
                        <a href="http://www.gopivotal.com/oss" id="oss-nav-link">OSS</a>
                    </li>
                    <li class="nav-search">
                        <a class="js-search-input-open" id="click-to-search"><span></span></a>
                    </li>
                </ul>
            </div>
            <a href="http://www.gopivotal.com/contact">
                <img id="get-started" src="http://www.gopivotal.com/sites/all/themes/gopo13/images/get-started.png">
            </a>
        </div>
      </header>
      <div class="main-wrap">
        <div class="container-fluid">

          <!-- Google CSE Search Box -->
          <div id='docs-search'>
              <gcse:search></gcse:search>
          </div>

          <div id='all-docs-link'>
            <a href="/">All Documentation</a>
          </div>

          <div class="container">
            <div id="sub-nav" class="nav-container">
          <ul class="menu">
            <li class="first expanded js-maintopic"><a id='home-nav-link' href="/rabbitmq-cf/index.html">Overview</a></li>
            <li class="first expanded js-maintopic"><a href="/rabbitmq-cf/managing.html">Installing and Managing the RabbitMQ Service</a></li>
            <li class="first expanded js-maintopic"><a href="/rabbitmq-cf/vcap-services.html">RabbitMQ Entries in the VCAP_SERVICES Environment Variable</a></li>
            <li class="first expanded js-maintopic"><a href="/rabbitmq-cf/rabbitmq-cluster.html">Accessing the RabbitMQ Cluster Directly</a></li>
            <li class="first expanded js-maintopic"><a href="http://previous.rabbitmq.com/v3_2_x/documentation.html"  target="_blank">Using RabbitMQ</a></li>
          </ul>
</div><!--end of sub-nav-->

            <div class="body-container content">

           <ul class="breadcrumbs"> <li><a href="/rabbitmq-cf/index.html">Pivotal RabbitMQ Documentation</a></li> <li class="active"><span>RabbitMQ Entries in the VCAP_SERVICES Environment Variable</span></li></ul>
                    
                    <h3 class="title-container">RabbitMQ Entries in the VCAP_SERVICES Environment Variable</h3>
                    <p>Applications running in Cloud Foundry gain access to service instances which are bound to them by credentials passed to them through the <code>VCAP_SERVICES</code> environment variable available to the application. Here is an example:</p>
<p><pre><code>
{"p-rabbitmq-3.1.5":
  [{"name": "myrabbit",
    "label": "p-rabbitmq-3.1.5",
    "tags":["rabbitmq","messaging","message-queue","amqp"],
    "plan": "standard",
    "credentials":
      {"uri": "amqp://u6e10e2df0903ecac86bc03f396c6d2b56089769b:p262615006c0001a482577e0d7a5400dca3ed40c3@10.26.152.25/5686900df5c8a9fa28668536ce0d3ddba206c3d4",
       "vhost": "5686900df5c8a9fa28668536ce0d3ddba206c3d4",
       "username": "u6e10e2df0903ecac86bc03f396c6d2b56089769b",
       "password": "p262615006c0001a482577e0d7a5400dca3ed40c3",
       "hostname": "10.26.152.25",
       "http_api_uri": "http://u6e10e2df0903ecac86bc03f396c6d2b56089769b:p262615006c0001a482577e0d7a5400dca3ed40c3@10.26.152.25:15672/api/",
       "protocols":
         {"amqp":
           {"uri": "amqp://u6e10e2df0903ecac86bc03f396c6d2b56089769b:p262615006c0001a482577e0d7a5400dca3ed40c3@10.26.152.25:5672/5686900df5c8a9fa28668536ce0d3ddba206c3d4",
            "username": "u6e10e2df0903ecac86bc03f396c6d2b56089769b",
            "password": "p262615006c0001a482577e0d7a5400dca3ed40c3",
            "port": 5672,
            "host": "10.26.152.25",
            "vhost": "5686900df5c8a9fa28668536ce0d3ddba206c3d4"},
          "management":
            {"uri": "http://u6e10e2df0903ecac86bc03f396c6d2b56089769b:p262615006c0001a482577e0d7a5400dca3ed40c3@10.26.152.25:15672/api/",
             "username": "u6e10e2df0903ecac86bc03f396c6d2b56089769b",
             "password": "p262615006c0001a482577e0d7a5400dca3ed40c3",
             "port": 15672,
             "host": "10.26.152.25",
             "path": "/api/"}
         }
      }
   }]
}</code></pre></p>
<p>The properties of the <code>credentials</code> object serve two purposes. Firstly, for backwards compatibility with other cloud messaging providers, the <code>uri</code>, <code>vhost</code>, <code>username</code>, <code>password</code> and <code>hostname</code> properties are provided directly. However, these will only ever reflect access to RabbitMQ over AMQP. Using these properties is discouraged.</p>
<p>Secondly, a more flexible approach is provided by the <code>credentials.protocols</code> object. This object has a key per protocol enabled in the RabbitMQ broker. In this example we have just the keys <code>amqp</code> and <code>management</code>, but other possible keys include <code>mqtt</code> and <code>stomp</code>. Note that if SSL is enabled via the installer, then the keys for <code>amqp</code> and <code>management</code> will be adjusted to <code>amqp+ssl</code> and <code>management+ssl</code> respectively. However other protocols are not automatically adjusted for use with the supplied SSL keys and require configuration by supplying a custom <code>rabbitmq.config</code> file via the installer. The values associated with each of these keys gives access credentials specific to each protocol. In all cases, a full URI is provided, along with the individual components to facilitate ease of use with client libraries that do not support the full URIs.</p>
<h2>Updating the VCAP_SERVICES Environment Variable</h2>
<p>If you adjust the plugins and protocols enabled for RabbitMQ via the installer you will need to force the <code>VCAP_SERVICES</code> environment variables to be regenerated. In common with all services in Pivotal Cloud Foundry, the <code>VCAP_SERVICES</code> environment variable for an application is only modified when the application is bound to a service instance. Thus to update it so that it reflects the current set of protocols and features enabled in RabbitMQ, you need to unbind the application from the relevant RabbitMQ service instance, then rebind it, and then restart the application. The application should then find updated environment variables reflecting the current set of enabled protocols.</p>

        </div><!-- end of body-container content-->
          </div><!-- end of container -->
        </div><!--end of container-fluid-->
      </div><!--end of main-wrap-->

      <div class="site-footer desktop-only">
          <div class="container-fluid">
              <div class="site-footer-links">
                  <span class="version"><a href='/'>Pivotal Documentation</a></span>
                  <span>&copy;
                      <script>
                          var d = new Date();
                          document.write(d.getFullYear());
                      </script>
                      <a href='http://gopivotal.com'>Pivotal Software</a> Inc. All Rights Reserved.
                  </span>
              </div>
          </div>
      </div>

      <script type="text/javascript">
          (function() {
              var didInit = false;
              function initMunchkin() {
                  if(didInit === false) {
                      didInit = true;
                      Munchkin.init('625-IUJ-009');
                  }
              }
              var s = document.createElement('script');
              s.type = 'text/javascript';
              s.async = true;
              s.src = document.location.protocol + '//munchkin.marketo.net/munchkin.js';
              s.onreadystatechange = function() {
                  if (this.readyState == 'complete' || this.readyState == 'loaded') {
                      initMunchkin();
                  }
              };
              s.onload = initMunchkin;
              document.getElementsByTagName('head')[0].appendChild(s);
          })();
      </script>
  </div><!--end of viewport-->
  <div id="scrim"></div>
</body>
</html>
